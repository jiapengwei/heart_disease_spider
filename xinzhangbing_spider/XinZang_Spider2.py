# -*- coding: utf-8 -*-
import re
import requests


################################################################################
# id_data = []  #存放所有id
#
# for page_id in range(1, 51):
#     try:
#
#         page_url = 'http://so.xywy.com/wenda.php?keyword=心脏病&src=so&page=%d' % page_id
#         # headers = {
#         #
#         #         'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/534.13 (KHTML, like Gecko) Chrome/9.0.597.0 Safari/534.13',
#         #         'Referer': 'http://so.xywy.com/wenda.php?keyword=心脏病&src=so&page=%d' % page_id
#         #     }
#         r = requests.get(page_url)
#
#         # print(r.text)
#         r.encoding = ('utf-8')
#         html = r.text
#         # print(html)
#         # lis = re.findall(r'<a href="/question/[0-9]+.html">', html, re.S)
#         # lis = set(lis)
#
#         ids = re.findall(r'<a href="http://club.xywy.com/question/20160215/(\d+).htm"', html)
#         # print(ids)
#         ids = set(ids)
#         for i in ids:
#             id_data.append(int(i))
#     except:
#         pass
#
# print(id_data)
######################################################################################

# 存放所有id
id_data = [80718006, 102772830, 24406046, 58899576, 100646945, 103870956, 53066763, 112232572, 109901065, 100978850, 1905625, 118749841, 105810404, 66646155, 102483546, 49545480, 19574770, 95955674, 98994322, 55268797, 6486294, 104475789, 5956587, 19899395, 63733413, 6531116, 36280368, 97062253, 6774755, 6774634, 96084444, 33875904, 58315727, 5029190, 29847068, 9357372, 1870171, 33860394, 57654297, 62487265, 91100972, 298606, 60014913, 33923380, 22228308, 675803, 9377324, 103870658, 2073358, 4701593, 33875089, 106036189, 73377749, 108883966, 73937314, 52127769, 33873933, 1852562, 74845559, 101321254, 4550796, 76818223, 65854252, 48122910, 60052515, 12037476, 58306065, 24108873, 70167932, 67204914, 1690664, 93249050, 69297097, 56788333, 69885678, 26174692, 56128168, 7281834, 54498949, 36090698, 61090850, 90439957, 47045634, 61129137, 53202338, 15362286, 39536259, 14896773, 60747326, 54104088, 4367292, 11613058, 16000464, 12749505, 1699615, 29416524, 31534539, 11403839, 5440664, 324242, 36395614, 13203390, 33303702, 7891480, 14233800, 35970353, 32028196, 39535316, 67973586, 2226371, 112841910, 1864295, 14304326, 7258023, 29411239, 49230243, 46780446, 104347172, 51074864, 30381705, 31731203, 13432649, 37693615, 29402669, 8953966, 32485710, 29462649, 3392314, 22503901, 12519138, 31018120, 9830031, 15256443, 17767921, 15271725, 62263472, 30308352, 33900171, 16324879, 90881259, 14239399, 531371, 103859741, 28093743, 15759188, 1678921, 104183959, 19981792, 33240255, 5259500, 9481878, 51882563, 48801076, 17830397, 63475205, 12476072, 29470689, 30376854, 29423952, 69144738, 3423541, 33816537, 29438322, 106795053, 13155416, 13202872, 11337114, 31726015, 29441166, 33967395, 7277011, 18899176, 14904272, 39994663, 34011701, 18795874, 45717841, 42584590, 47634531, 37805608, 12086328, 38557619, 48384613, 5990388, 37753069, 45643424, 8325116, 2529994, 29418631, 39522517, 13365015, 10583339, 4730327, 106279327, 1494417, 54674302, 68261269, 5377930, 69126178, 13475618, 36573065, 29482123, 28895586, 6069491, 6048297, 29433657, 13830398, 10874676, 10618168, 28102694, 104243126, 4916970, 5591893, 27076229, 102146476, 15443366, 9544525, 29415787, 24908079, 13561380, 65586188, 2280769, 96296016, 29423177, 2073290, 29416640, 50322969, 29412665, 35047586, 73646895, 19159598, 21033885, 29464572, 36183006, 18639647, 31084573, 74537329, 30377273, 74262003, 37454164, 6692329, 14976040, 15490839, 2215054, 43583053, 10365644, 32190385, 601862, 2576968, 109072552, 15622610, 14458348, 27752372, 63057198, 13065211, 651023, 34077682, 4710359, 44414798, 62416994, 29412865, 30506878, 27493714, 35047554, 38360450, 31028650, 2150670, 29482673, 104715788, 13334946, 71444494, 99599736, 31272163, 23244371, 35477037, 12115871, 61003214, 14612307, 52921562, 50386611, 39433242, 38994511, 12836802, 15925750, 18414187, 6821701, 2093860, 65622348, 17751714, 53541065, 29477341, 14298786, 7795058, 48998537, 18601629, 44761991, 14295299, 29461205, 74909346, 41092018, 68577705, 48075032, 2150720, 723148, 98041614, 5865889, 1438674, 1587503, 60488405, 4001398, 59358993, 104386083, 39387788, 66515644, 52595081, 18337078, 29424709, 12535535, 12336589, 41522797, 13580004, 37238356, 12767501, 37432073, 29408006, 17077474, 7369866, 6488151, 48623099, 37238293, 2215078, 25770312, 75020199, 1912422, 29423865, 30365501, 29471220, 98300023, 96312093, 49167736, 37048850, 11190153, 17778090, 1649007, 9043542, 29479255, 29417587, 36319509, 44326008, 98729008, 29676885, 29434014, 21627913, 47662374, 28204878, 29464662, 75965281, 4250745, 30378042, 1883071, 124292672, 12480107, 13168952, 14123673, 104617736, 52823227, 19370590, 13476218, 14603593, 16634456, 9945435, 18882272, 6052370, 14718873, 24695374, 15437181, 4550398, 6175427, 106297153, 29479821, 29480025, 13797575, 16407921, 29425242, 104964538, 6756431, 104343410, 105718378, 68953104, 5990331, 17274986, 28367141, 43222423, 51641146, 9867998, 92750058, 13947305, 15002158, 10759181, 10199255, 10199286, 76542822, 2226789, 33007113, 27967166, 13427058, 16603871, 8904366, 6063762, 29413018, 33461339, 33318011, 50640050, 32490666, 10985300, 12405385, 3913420, 29448414, 13471783, 107310217, 49593905, 30387160, 79594540, 30357550, 51495420, 63733703, 55256470, 61792193, 107690708, 18963427, 63470961, 33298753, 30357860, 21142642, 10741678, 17405278, 64970837, 2663135, 70846959, 108523020, 5042391, 4879872, 33881020, 104922220, 1779625, 60710673, 2073303, 32603631, 113275786, 39271571, 18324532, 8269834, 29471490, 11769275, 41854556, 29433933, 14095340, 12885512, 10840702, 33207768, 16665488, 29476969, 13839932, 14822414, 19982519, 9831652, 78181940, 114994383, 118740998, 7194140, 5704879, 54434657, 54969908, 43255746, 30517497, 74520598, 55189037, 75040551, 53067110, 107828848, 60138125, 65367031, 73021739, 26547215, 125806520, 59522214, 33863526, 46403791, 113670949, 30137642, 61023514, 92012272, 104589368, 31171364, 52536476, 35086935, 53408580, 52173542, 110555152, 99790098, 40063438, 110554952, 51908597, 7314655, 101423016, 46744632, 108826000, 33881090, 33867170, 61399037, 54062129, 52344063, 116549098, 54206871, 50940577, 113889780, 109628247, 38244942, 26667271, 94239556, 99888506, 40263551, 2697187, 49604903, 105976715, 39813115, 45782256, 48123361, 52028999, 92360282, 39067697, 112823233, 4633149, 35503578, 108884930, 115899983, 90634724, 28221709, 51756508, 43162205, 46690115, 33871486, 22006434, 30984905, 60210780, 43591136, 67123957, 25349247, 29161941, 62797871, 68567248, 33880598, 30731495, 56512364, 29212099, 45858810, 26274783, 25397097, 50083214, 42337629, 21242796, 45229363, 18471328, 32786586, 659516, 102522593, 13629594, 30732488, 29639816, 51197249, 52526955, 3028855, 33559605, 50375160, 78300289, 98560134, 54698903, 57828789, 13499983, 1966432, 45494116, 52589251, 11333642, 44924238, 101031435, 57109626, 123890594, 53555219, 19416877, 30605853, 8443853, 71036296, 52505476, 59835170, 55952020, 47028748, 62713405, 50325039, 55002090, 63358327, 22049576, 58738199, 4060021, 52836929, 5499195, 52589621, 4041800, 51991087, 92459848, 2680627, 54573233, 66701746, 54272852, 11716945, 2581330, 72882336, 10693187, 2666830, 9733578, 57568562, 68666616, 9649338, 50803205, 125806474, 4594637, 55000395, 7516975, 51386634, 106978814, 2623819, 66314701, 55691758, 5653845, 52448254, 120132461, 68462335, 51889609, 64053641, 13346635, 107321798, 59525742, 46522771, 43967741, 27861158, 23914687, 65953639, 54220491, 61941185, 53488304, 77397556, 60260935, 59001103, 39792710, 72310384, 55459319, 48360078, 77699863, 21847743, 21651984, 53511299, 12758025, 110646485, 35979666, 67495102, 10275700, 38055825, 103718422, 20902445, 55495431, 52322914, 37163811, 91944084, 59806268, 55430239, 22564089, 63220745, 22905079, 23091718, 35634339, 43071744, 50672715, 47603335, 67798584, 24223558, 4630500, 53578958, 30562500, 9725406, 42270202, 19274819, 51699242, 106733351, 45917736, 54576869, 102209430, 11662424, 54988999, 48053699, 93612472, 72319251, 33554710, 66276485, 34872369, 71286602, 53991977, 29350112, 13403767, 63387729, 54195070, 33923283, 4909292, 14179856, 1735968, 21421788, 77471699, 42248760, 31593899, 14116789, 11909453, 12589774, 31994806, 6906528, 45103949, 3521673, 53287611, 4994390, 4305213, 53782736, 9483534, 5217657, 54684553, 11464435, 4521910, 1738201, 7259313, 6930677, 67632026, 95535, 10771972, 24685498, 5971874, 11694507, 6784242, 3459947, 4372934, 56775856, 9970825, 45530359, 35439123, 70306320]
print(len(id_data))  # 750个网页
with open('QA22.txt', 'a') as ff:
    ff.write('XinZang_Spider2')
    ff.write('\n')

for id in id_data:
    url = 'http://club.xywy.com/question/20160215/%d.htm' % id
    headers = {

                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36',
                    'Referer': url
                }
    try:
        r = requests.get(url, headers=headers)
        r.encoding = ('gbk')
        html = r.text
        # print(html)
        lis_Q = re.findall(r'<i class="icons fYaHei">问</i><span>(.*?)</span>', html, re.S)
        # for i in lis_Q:
        #     print(i)
        #     with open('QA22.txt', 'a') as ff:
        #         ff.write(i)
        #         ff.write('\n')
        lis_A = re.findall(r'<b>意见建议：</b>(.*?)</div>', html, re.S)
        for i in range(len(lis_Q)):
            # print(lis_Q[i])
            # with open('QA22.txt', 'a') as ff:
            #     ff.write(lis_Q[i])
            #     ff.write('\n')
            try:
                # print(lis_A[i])
                with open('QA22.txt', 'a') as ff:

                    ff.write(lis_A[i])
                    ff.write('\n')

                    ff.write(lis_Q[i])
                    ff.write('\n')
                    ff.write('\n')

            except:
                with open('QA22.txt', 'a') as ff:
                    ff.write('\n')
            # print('\n')


    except:
        pass
    print(id)

